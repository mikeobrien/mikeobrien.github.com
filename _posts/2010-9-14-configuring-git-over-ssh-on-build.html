---
layout: post
title: Configuring Git Over SSH on a Build Server
tags: [ThoughtWorks Go, Git, Build/Deploy]
---
<p>When you run Git for the first time over ssh you'll probably be greeted with this:</p>  <p><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/blog/images/b3fefbf652a4436997c433b7bf948b5d.png" width="668" height="142" /> </p>  <p>This is no good if this command is running in a windows service as there will be no way for it to respond. When you enter yes to this prompt a file called known_hosts that lets ssh know that this host is ok:</p>  <p></p>  <p><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/blog/images/dfc67670068a4829b9da25076f5ba03e.png" width="499" height="116" /> </p>  <p>This file is created in the .ssh folder under your user profile (Usually C:\Users\&lt;Username&gt;) where ssh can refer back to it (And not prompt you again). The .ssh folder is also where your public and private keys (id_rsa &amp; id_rsa.pub) are stored for writing to a git repository. </p>  <p>Now the nice thing is you can run a git command like clone on you local machine, answer yes to the above prompt and then copy the generated know_hosts file from your local machine to your build server so that it's not prompting during the build process. You can also copy over your public/private keys if your build process needs to write to the repository for some reason. </p>  <p>There are two possible locations where you will need to place these files on your build server in order for ssh to pick them up. One is the folder under the user profile &quot;C:\Users\&lt;Username&gt;\.ssh&quot; (That we already mentioned). Your build server service(s) should be running under a user account (Not as LocalSystem, tisk tisk!) and the username would be that of the account the service is running under. If your running under LocalSystem I would assume that you would have to put the files under &quot;C:\Users\Default\.ssh&quot; but that's just a guess as I've not actually tried it. The other location, if you used the msysgit installer, is in the git binary folder under program files ; &quot;%PROGRAM_FILES%\Git\.ssh&quot;. Interestingly, in the process of setting up git to work with Go I found that when the build <strong><em>server</em></strong> ran ssh it looked under &quot;%PROGRAM_FILES%\Git\.ssh&quot; and when the build <strong><em>agent</em></strong> ran it looked under &quot;C:\Users\&lt;Username&gt;\.ssh&quot;. I have no clue why it would look in different spots but that's what it was doing so beware. If all else fails you can fire up <a href="http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx">procmon</a> and see where its looking (Which is what I did).</p>  <p>Once these files are in place you may need to restart the build server services in order for it to pick up the new files.</p>  