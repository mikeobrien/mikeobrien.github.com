---
layout: post
title: Another Imperative vs. Functional Post
tags: [Functional Programming, .NET]
---
<p>Today I was implementing a simple class of db access primitives for our acceptance tests and caught myself using an imperative approach.</p>  <p>First, the imperative approach: </p>  <pre class="code">command.CommandText += <span style="color: #a31515">&quot; WHERE &quot;</span>;

<span style="color: blue">for </span>(<span style="color: blue">int </span>index = 0; index &lt; filter.Length; index++ )
{
    command.CommandText += <span style="color: blue">string</span>.Format(<span style="color: #a31515">&quot;{1}{0} = @{0}&quot;</span>, filter[index].Key, index &gt; 0 ? <span style="color: #a31515">&quot; AND &quot; </span>: <span style="color: blue">string</span>.Empty);
    command.Parameters.AddWithValue(<span style="color: #a31515">&quot;@&quot; </span>+ filter[index].Key, filter[index].Value);
}</pre>
<a href="http://11011.net/software/vspaste"></a><a href="http://11011.net/software/vspaste"></a>

<p>Now the functional version:</p>

<pre class="code">command.CommandText += <span style="color: #a31515">&quot; WHERE &quot; </span>+ filter.
                          Select(clause =&gt; <span style="color: blue">string</span>.Format(<span style="color: #a31515">&quot;{0} = @{0}&quot;</span>, clause.Key)).
                          Aggregate((a, i) =&gt; <span style="color: blue">string</span>.Format(<span style="color: #a31515">&quot;{0} AND {1}&quot;</span>, a, i));

command.Parameters.AddRange(
        filter.Select(clause =&gt; <span style="color: blue">new </span><span style="color: #2b91af">SqlParameter</span>(<span style="color: #a31515">&quot;@&quot; </span>+ clause.Key, clause.Value)).ToArray());</pre>
<a href="http://11011.net/software/vspaste"></a><a href="http://11011.net/software/vspaste"></a><a href="http://11011.net/software/vspaste"></a><a href="http://11011.net/software/vspaste"></a><a href="http://11011.net/software/vspaste"></a>

<p>Much simpler IMO.</p>  