---
layout: post
title: Connecting to a local SQL Server with a host name set in the Hosts File using Windows Authentication (SSPI)
tags: [.NET, SQL Server 2005]
redirect_from:
  - /blog/2008/10/connecting-to-local-sql-server-with.html
---
<p>If you have a host name set in your hosts file pointing to your loop back address and you are trying to connect to your <em>local</em> SQL Server instance with this host name using Windows Auth (SSPI) you may receive one of the following errors depending on how you have things configured:  <p>"Login failed for user ''. The user is not associated with a trusted SQL Server connection."  <p>Or  <p>Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'  <p>There could be a number of things causing this error (<a href="http://blogs.msdn.com/sql_protocols/archive/2008/05/03/understanding-the-error-message-login-failed-for-user-the-user-is-not-associated-with-a-trusted-sql-server-connection.aspx">here</a>, <a href="http://blogs.msdn.com/sql_protocols/archive/2005/10/22/sql-server-2005-connectivity-issue-troubleshoot-part-i.aspx">here</a>, <a href="http://blogs.msdn.com/sql_protocols/archive/2005/10/29/486861.aspx">here</a> and <a href="http://blogs.msdn.com/sql_protocols/archive/2005/12/22/506607.aspx">here</a>) but it in the specific scenario noted above it's probably that an alias is not set for the SQL Server. I'm not sure exactly why or how this works or why the above scenario would have an issue but creating an alias seems to resolve it. In fact if you specify "localhost" or the loopback address as the server name it works fine (Without the alias). Also when connecting to a remote SQL Server with a host name defined in the hosts file it works fine as well. hmmmm.... I really couldn't find any info on this specific scenario and creating the alias seems to resolve it so I finally gave up. If you have any more info on why this would happen please leave a comment. You can set the alias as follows: <ol> <li>1) Open the SQL Server Configuration Manager under Start|Programs| Microsoft SQL Server 20xx| Configuration Tools| SQL Server Configuration Manager.</li> <li>2) Under the SQL Native Client Configuration node select Aliases.</li> <li>3) Right-click and select "New Alias...".</li> <li>4) Enter the following information and press OK:</li> <ol> <li>Alias Name: sql.somedomain.com</li> <li>Port No: 1433</li> <li>Protocol: TCP/IP </li> <li>Server: localhost</li></ol></ol> <p>The connection string would be as follows:</p> <p>server=sql.somedomain.com;database=SomeDatabase;Integrated Security=SSPI</p>