---
layout: post
title: Defining a SharePoint list image with VSeWSS
tags: [VSeWSS, SharePoint 2007, SharePoint Solution Deployment]
redirect_from:
  - /blog/2007/06/defining-sharepoint-list-image-with.html
---
<P>At some point you may want to define an "icon" for your SharePoint list templates. Doing this is kindof quirky and the <A href="http://msdn2.microsoft.com/en-us/library/ms439434.aspx" target=_blank>SDK doesn't seem to mention the quirk</A>&#160;(At least I couldn't find it anywhere). </P>
<P>Basically icons will appear in a few&#160;places, for example the Create page when you hover over the list and the the site content summary page.</P>
<P align=center><A href="http://blog.mikeobrien.net/content/binary/DefiningaSharePointlistimagewithVSeWSS_9E70/image.png" atomicselection="true"><IMG style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" height=274 alt=image src="/blog/images/b957f313265f4e478b0dc11fea8bb696.png" width=404 border=0></A></P>
<P></P>
<P align=center><A href="http://blog.mikeobrien.net/content/binary/DefiningaSharePointlistimagewithVSeWSS_9E70/image_3.png" atomicselection="true"><IMG style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" height=305 alt=image src="/blog/images/c09c594b6cdf47f1881d4ab33e44aec7.png" width=484 border=0></A></P>
<P></P>
<P>You can define an image to be displayed in the VSeWSS Solution Properties as shown below:</P>
<P align=center><A href="http://blog.mikeobrien.net/content/binary/DefiningaSharePointlistimagewithVSeWSS_9E70/image_4.png" atomicselection="true"><IMG style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" height=378 alt=image src="/blog/images/daf9158e094144d0be445b7d5ec9e3ca.png" width=676 border=0></A></P>
<P></P>
<P>Here I am referencing a 16x16 png called INotice.png. Now for the quirky part... The image path set above will be referenced as-is in the site content summary page (The first image show above) where the small image (16x16)&#160;is used. But how do you define the larger image (32x32) used in the Create List form (Show above)? Basically the Create List page takes the url entered into the&#160;list Element Manifest Image property above (Which corresponds&#160;to the Image attribute of the <A href="http://msdn2.microsoft.com/en-us/library/ms439434.aspx" target=_blank>ListTemplate element</A> in the List template manifest file) and replaces the first letter of the filename with an "L". So it would change the image url above to "/PhvenEleaseResources/<STRONG><FONT color=#ff0000>L</FONT></STRONG>Notice.png". In this case you would see a broken image link&#160;when you hovered over your list template. </P>
<P>So you need to deploy 2 images, first a small image (16x16) with some arbitrary prefix character like "I" ("I" is the&#160;prefix used by OOB small SharePoint images, but it can be any character), for example "IMyListImage.gif". Set the Image URL in the VSeWSS list element manifest (As shown above), for example "/MyImages/IMyListImage.gif". Additionally, deploy a large image (32x32) that has the<STRONG> same name</STRONG> as your small image <STRONG>but starts with an "L" instead</STRONG>, for example "<FONT color=#ff0000>L</FONT>MyListImage.gif". SharePoint will then correctly display the large and small images appropriately. </P>
<P>Now, you may be asking, how do I&#160;deploy those list images <STRONG>using VSeWSS and Solution Deployment</STRONG>? The best way I could find (Using only VSeWSS) is to create a module.&#160; </P>
<P align=center><A href="http://blog.mikeobrien.net/content/binary/DefiningaSharePointlistimagewithVSeWSS_9E70/image_5.png" atomicselection="true"><IMG style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" height=301 alt=image src="/blog/images/8f7b8ffa280d4926bdd75aae9c3405fa.png" width=627 border=0></A></P>
<P></P>
<P>Once created, remove the sample file and reference from the new module. Copy your list images into the the new module folder and reference them in the module definition as demonstrated below. </P><FONT color=#0000ff size=2>
<P><?</FONT><FONT color=#800000 size=2>xml</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>version</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>1.0</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>encoding</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>utf-8</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>?></P>
<P><!--</FONT><FONT color=#008000 size=2> _filecategory="Module" _filetype="File" _filename="module.xml" _uniqueid="7d203b86-3fe2-46cb-ba36-bb255430ce6f" </FONT><FONT color=#0000ff size=2>--></P>
<P><</FONT><FONT color=#800000 size=2>Elements</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>xmlns</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>http://schemas.microsoft.com/sharepoint/</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>></P>
<P>&#160;&#160;&#160;&#160;<</FONT><FONT color=#800000 size=2>Module</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>MyImages</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Url</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>MyImages</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>RootWebOnly</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>TRUE</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>></P>
<P>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<</FONT><FONT color=#800000 size=2>File</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Url</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>LMyListImage.gif</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Type</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Ghostable</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>/> <!--&#160;<FONT color=#008000>Large image (32x32)</FONT> --></P>
<P>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<</FONT><FONT color=#800000 size=2>File</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Url</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>IMyListImage.gif</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Type</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Ghostable</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>/> <!--&#160;<FONT color=#008000>Small image (16x16)</FONT> --></P>
<P>&#160;&#160;&#160;&#160;</</FONT><FONT color=#800000 size=2>Module</FONT><FONT color=#0000ff size=2>></P>
<P></</FONT><FONT color=#800000 size=2>Elements</FONT><FONT color=#0000ff size=2>></P></FONT>
<P>Once deployed the two images can be referenced as "/MyImages/IMyListImage.gif" and "/MyImages/LMyListImage.gif" where the Module&#160;Url attribute defines the path off the root of the site.</P>