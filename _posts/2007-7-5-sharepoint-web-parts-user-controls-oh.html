---
layout: post
title: SharePoint & Web Parts &amp; User Controls, Oh My!
tags: [Visual Studio 2005, .NET, VSeWSS, SharePoint 2007, C#, SharePoint Solution Deployment]
---
<p>I must say, the OOB development experience in SharePoint has been less than desirable. I feel like MS has given us a number of tools but left us in the lurch figuring out how to use them, and its not always obvious how.&#160;One thing I have wanted to do is use the designer to develop web parts and deploy them with the click of a button. The VSeWSS have made the "deploy with the click of the button" part possible but the designer part has not been so obvious. How can you marry a designer experience with the VSeWSS ease of solution&#160;deployment? I'll show you how...</P><p><strong>For Starters</STRONG></P><p>The following information utilizes the Visual Studio Extensions for WSS (VSeWSS) which can be downloaded <a href="http://www.microsoft.com/downloads/details.aspx?familyid=19f21e5e-b715-4f0c-b959-8c6dcbdc1057&displaylang=en">here</A>. VSeWSS only offers a subset of the features available with solution deployment but offers "one touch" deployment OOB. Creating your own solutions manually will give you more options but may be more work than its worth (Unless you have found some nifty 3rd party tool or created your own). So the following information will strictly&#160;use what VSeWSS has to offer.&#160;VSeWSS can only run on a Windows Server 2003&#160;box with MOSS 2007&#160;& Visual Studio 2005 installed (Although it can be hacked to run on XP, most of the features do not work). VSeWSS may have problems if MOSS 2007 was not installed as a standalone server, so says the download notes and my experience with it. Although I have a colleague who has used it in a farm configuration and not had an issue.</P><p><strong>Creating a blank VSeWSS Project & Web Part</STRONG></P><p>Obviously you cant use the designer with a web part but you can with a Web User Control (This is the thought behind <a href="http://www.microsoft.com/belux/msdn/nl/community/columns/u2u/smartpart.mspx">SmartParts</A>). So lets start off by creating a project from an empty&#160;VSeWSS template. </P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image.png" atomicselection="true"><img style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=449 alt=image src="/content/94ac271131634005979d8d0b32881eff.png" width=648 border=0></A> </P><p>Next add a new Web Part from the VSeWSS templates.</P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image_3.png" atomicselection="true"><img style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=294 alt=image src="/content/91ffd15c4ba74e7db5769e898d50282e.png" width=615 border=0></A> </P><p>Now your probably thinking "Now add a Web User Control, yada yada yada", right? Wrong! If you have gone down this path before you will probably discover a couple of things; first the Web User Control is not available as a new item in a VSeWSS project. This can be worked around fairly easily by modifying the templates available to the class library project type or by creating the user control in a Web Application Project (WAP) and copy the files over, either way hacky. Second, you will discover that the designer does not behave as it does in a WAP or web site. For example your code behind and designer classes are not linked together and when you double click a control the default event code is generated in the ascx file instead of the code behind. This and a number of other quirks render this method almost as bad as just coding your entire control in the Web Part (Almost, but not quite). So how do we get the designer to work properly? .</P><p><strong>Creating a hybrid VSeWSS/WAP Project</STRONG></P><p>We need to create a hybrid VSeWSS/WAP project. This requires that you either have <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=BB4A75AB-E2D4-4C96-B39D-37BAF6B5B1DC&displaylang=en">VS2005 SP1</A> installed or the <a href="http://msdn2.microsoft.com/en-us/asp.net/aa336618.aspx">WAP extensions</A> installed (If you decided not to wait 5 hours for SP1 to install...). In order to make your VSeWSS project also a WAP project you will need to adjust the project type in the .xxproj file. To do this, right click the project we just created an select "Unload Project". It may ask you to save, press yes.</P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image_4.png" atomicselection="true"><img style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=332 alt=image src="/content/141cc951e8a54395b066efea5543dae1.png" width=294 border=0></A> </P><p>Once the project is unloaded, right click it again and select "Edit xxxxxxxxxxx.xxproj".</P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image_5.png" atomicselection="true"><img style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=214 alt=image src="/content/5b6d3101f2f141ac83544b931c2d3dcd.png" width=294 border=0></A> </P><p>Once you have opened the project file you will need to add in the WAP guid into the ProjectTypeGuids element under the first PropertyGroup. This guid, <strong><em>{349c5851-65df-11da-9384-00065b846f21}</EM></STRONG>, should be the <strong><em>second</EM></STRONG> guid in the list (Shown in bold/green below), the first one being the VSeWSS project guid. All the guids in this element should be separated by a semicolon as shown below. </P><p><div style="FONT-SIZE: 10pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: courier new"><p style="MARGIN: 0px"><span style="COLOR: blue"><</SPAN><span style="COLOR: maroon">Project</SPAN><span style="COLOR: blue"> </SPAN><span style="COLOR: red">DefaultTargets</SPAN><span style="COLOR: blue">=</SPAN>"<span style="COLOR: blue">Build</SPAN>"<span style="COLOR: blue"> </SPAN><span style="COLOR: red">xmlns</SPAN><span style="COLOR: blue">=</SPAN>"<span style="COLOR: blue">http://schemas.microsoft.com/developer/msbuild/2003</SPAN>"<span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; <</SPAN><span style="COLOR: maroon">PropertyGroup</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">ProductVersion</SPAN><span style="COLOR: blue">></SPAN>8.0.50727<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">ProductVersion</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">SchemaVersion</SPAN><span style="COLOR: blue">></SPAN>2.0<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">SchemaVersion</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">ProjectGuid</SPAN><span style="COLOR: blue">></SPAN>{7A3CF036-DC02-4868-8CBA-A88E75552372}<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">ProjectGuid</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">ProjectTypeGuids</SPAN><span style="COLOR: blue">></SPAN>{9E5D3E2D-E4E2-418e-8D80-2F0DA9A94F9A};<strong><font size=3><font color=#00cc00>{349c5851-65df-11da-9384-00065b846f21}</FONT><font color=#00e100>;</FONT></FONT></STRONG>{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">ProjectTypeGuids</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">Configuration</SPAN><span style="COLOR: blue"> </SPAN><span style="COLOR: red">Condition</SPAN><span style="COLOR: blue">=</SPAN>"<span style="COLOR: blue"> '$(Configuration)' == '' </SPAN>"<span style="COLOR: blue">></SPAN>Debug<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">Configuration</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">Platform</SPAN><span style="COLOR: blue"> </SPAN><span style="COLOR: red">Condition</SPAN><span style="COLOR: blue">=</SPAN>"<span style="COLOR: blue"> '$(Platform)' == '' </SPAN>"<span style="COLOR: blue">></SPAN>AnyCPU<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">Platform</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">OutputType</SPAN><span style="COLOR: blue">></SPAN>Library<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">OutputType</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">RootNamespace</SPAN><span style="COLOR: blue">></SPAN>MyGroovySharePointLibrary<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">RootNamespace</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">AssemblyName</SPAN><span style="COLOR: blue">></SPAN>MyGroovySharePointLibrary<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">AssemblyName</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">SignAssembly</SPAN><span style="COLOR: blue">></SPAN>true<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">SignAssembly</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">AssemblyOriginatorKeyFile</SPAN><span style="COLOR: blue">></SPAN>Properties\Temporary.snk<span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">AssemblyOriginatorKeyFile</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; </</SPAN><span style="COLOR: maroon">PropertyGroup</SPAN><span style="COLOR: blue">></SPAN></P></DIV><p></P><p>&#160;After this has been set, right click the the project again and select "Reload Project". Click yes to save when prompted. </P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image_6.png" atomicselection="true"><img style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=229 alt=image src="/content/e0f34c15d03f4270a2f6360611f43b9e.png" width=293 border=0></A> </P><p>Now <strong>close out of Visual Studio</STRONG>, save your project when prompted.&#160;Restart Visual Studio and open your project.</P><p><strong>VSeWSS Deployment</STRONG></P><p>Now your probably thinking "<strong>Now</STRONG> add a Web User Control, yada yada yada", right? Well, yes, you can now add a Web User Control and its designer will work properly. <strong>But</STRONG> we want to be able to deploy it strictly with VSeWSS and its solution builder. In order to do this we will need to install the user control with a Module, so lets do that first. Right click your project and add a new Module. I will generically call it UserControls as I will want to add more user controls to it&#160;as I add web parts.</P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image_7.png" atomicselection="true"><img style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=296 alt=image src="/content/9a7aed52b1764162995760fd0d74eaa5.png" width=694 border=0></A> </P><p>Once your module is created you can delete the "sample.txt" file from the UserControls folder. Now right click the UserControls folder and click Add --> New Item and select the standard Web User Control.</P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image_8.png" atomicselection="true"><img style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=368 alt=image src="/content/3908de6abbb24b19b380a98fe67bff0c.png" width=651 border=0></A> </P><p>Next open the module.xml in the UserControls folder and add a reference to your newly created user control.</P><p><div style="FONT-SIZE: 10pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: courier new"><p style="MARGIN: 0px"><span style="COLOR: blue"><</SPAN><span style="COLOR: maroon">Elements</SPAN><span style="COLOR: blue"> </SPAN><span style="COLOR: red">xmlns</SPAN><span style="COLOR: blue">=</SPAN>"<span style="COLOR: blue">http://schemas.microsoft.com/sharepoint/</SPAN>"<span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; <</SPAN><span style="COLOR: maroon">Module</SPAN><span style="COLOR: blue"> </SPAN><span style="COLOR: red">Name</SPAN><span style="COLOR: blue">=</SPAN>"<span style="COLOR: blue">UserControls</SPAN>"<span style="COLOR: blue"> </SPAN><span style="COLOR: red">Url</SPAN><span style="COLOR: blue">=</SPAN>"<span style="COLOR: blue">UserControls</SPAN>"<span style="COLOR: blue"> </SPAN><span style="COLOR: red">Path</SPAN><span style="COLOR: blue">=</SPAN>""<span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; &#160; <</SPAN><span style="COLOR: maroon">File</SPAN><span style="COLOR: blue"> </SPAN><span style="COLOR: red">Url</SPAN><span style="COLOR: blue">=</SPAN>"<span style="COLOR: blue">MyGroovyUserControl.ascx</SPAN>"<span style="COLOR: blue"> /></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue">&#160; </</SPAN><span style="COLOR: maroon">Module</SPAN><span style="COLOR: blue">></SPAN></P><p style="MARGIN: 0px"><span style="COLOR: blue"></</SPAN><span style="COLOR: maroon">Elements</SPAN><span style="COLOR: blue">></SPAN></P></DIV><p></P><p>The Url attribute in the Module element specifies the relative&#160;path on the SharePoint site where the file will be deployed to. In this case I chose&#160;a sub folder called "UserControls". </P><p><strong>Creating the User Control and Linking the Web Part</STRONG></P><p>Now, add a label&#160;to your User Control called CurrentTime (Or whatever&#160;you&#160;want to call it...). And set it, in the control load event,&#160;to the current time.</P><p><div style="FONT-SIZE: 10pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: courier new"><p style="MARGIN: 0px"><span style="COLOR: blue">namespace</SPAN> MyGroovySharePointLibrary.UserControls</P><p style="MARGIN: 0px">{</P><p style="MARGIN: 0px">&#160;&#160;&#160; <span style="COLOR: blue">public</SPAN> <span style="COLOR: blue">partial</SPAN> <span style="COLOR: blue">class</SPAN> <span style="COLOR: teal">MyGroovyUserControl</SPAN> : System.Web.UI.<span style="COLOR: teal">UserControl</SPAN></P><p style="MARGIN: 0px">&#160;&#160;&#160; {</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; <span style="COLOR: blue">protected</SPAN> <span style="COLOR: blue">void</SPAN> Page_Load(<span style="COLOR: blue">object</SPAN> sender, <span style="COLOR: teal">EventArgs</SPAN> e)</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; {</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; CurrentTime.Text = <span style="COLOR: teal">DateTime</SPAN>.Now.ToString();</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; }</P><p style="MARGIN: 0px">&#160;&#160;&#160; }</P><p style="MARGIN: 0px">}</P></DIV><p></P><p>Since&#160;the&#160;VSeWSS&#160;Solution Builder creates a solution that installs <strong>only the project assembly&#160;to the GAC</STRONG> (Which is lame indeed) you will need to add an assembly directive to the user control, <strong>before</STRONG> the control directive is defined. If you do not add it <strong>before</STRONG> the control directive your control will fail to load as it will not have a reference to the project assembly in the GAC.</P><div style="FONT-SIZE: 10pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: courier new"><font size=2> <p><%</FONT><font color=#0000ff size=2>@</FONT><font size=2> </FONT><font color=#800000 size=2>Assembly</FONT><font size=2> </FONT><font color=#ff0000 size=2>Name</FONT><font color=#0000ff size=2>="MyGroovySharePointLibrary, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9f4da00116c38ec5"</FONT><font size=2> %></P><p><%</FONT><font color=#0000ff size=2>@</FONT><font size=2> </FONT><font color=#800000 size=2>Control</FONT><font size=2> </FONT><font color=#ff0000 size=2>Language</FONT><font color=#0000ff size=2>="C#"</FONT><font size=2> </FONT><font color=#ff0000 size=2>AutoEventWireup</FONT><font color=#0000ff size=2>="true"</FONT><font size=2> </FONT><font color=#ff0000 size=2>CodeBehind</FONT><font color=#0000ff size=2>="MyGroovyUserControl.ascx.cs"</FONT><font size=2> </FONT><font color=#ff0000 size=2>Inherits</FONT><font color=#0000ff size=2>="MyGroovySharePointLibrary.UserControls.MyGroovyUserControl"</FONT><font size=2> %></P></FONT><font color=#0000ff size=2> <p><</FONT><font color=#800000 size=2>asp</FONT><font color=#0000ff size=2>:</FONT><font color=#800000 size=2>Label</FONT><font size=2> </FONT><font color=#ff0000 size=2>ID</FONT><font color=#0000ff size=2>="CurrentTime"</FONT><font size=2> </FONT><font color=#ff0000 size=2>runat</FONT><font color=#0000ff size=2>="server"</FONT><font size=2> </FONT><font color=#ff0000 size=2>Text</FONT><font color=#0000ff size=2>="Label"></</FONT><font color=#800000 size=2>asp</FONT><font color=#0000ff size=2>:</FONT><font color=#800000 size=2>Label</FONT><font color=#0000ff size=2>></P></FONT></DIV><p>To obtain the public key token you can run the sn.exe utility in the SDK with the -T parameter and the path to the assembly. For example:</P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image_9.png" atomicselection="true"><img style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=200 alt=image src="/content/5b2a44ccea7b4e75b34e469d2a4b8897.png" width=666 border=0></A> </P><p>Next, override the CreateChildControls method of your web part and load the user control with the Page.LoadControl method. <em><strong>UPDATE: Thanks to Charles for pointing out that you also need to remove&#160;(If your not using it) the default Render(...) override. The WebPart template has this defined and by default&#160;it does not call the base implementation so ya get nothing displayed!</STRONG></EM></P><p><div style="FONT-SIZE: 10pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: courier new"><p style="MARGIN: 0px"><span style="COLOR: blue">namespace</SPAN> MyGroovyWebPart</P><p style="MARGIN: 0px">{</P><p style="MARGIN: 0px">&#160;&#160;&#160; [<span style="COLOR: teal">Guid</SPAN>(<span style="COLOR: maroon">"cc2a1b52-324a-4a20-bca8-0d512f8348b4"</SPAN>)]</P><p style="MARGIN: 0px">&#160;&#160;&#160; <span style="COLOR: blue">public</SPAN> <span style="COLOR: blue">class</SPAN> <span style="COLOR: teal">MyGroovyWebPart</SPAN> : </P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; System.Web.UI.WebControls.WebParts.<span style="COLOR: teal">WebPart</SPAN></P><p style="MARGIN: 0px">&#160;&#160;&#160; {</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; <span style="COLOR: blue">public</SPAN> MyGroovyWebPart()</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; {</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; <span style="COLOR: blue">this</SPAN>.ExportMode = <span style="COLOR: teal">WebPartExportMode</SPAN>.All;</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; }</P><p style="MARGIN: 0px">&#160;</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; <span style="COLOR: blue">protected</SPAN> <span style="COLOR: blue">override</SPAN> <span style="COLOR: blue">void</SPAN> CreateChildControls()</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; {</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; <span style="COLOR: blue">string</SPAN> userControl = <span style="COLOR: maroon">"/UserControls/MyGroovyUserControl.ascx"</SPAN>;</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; <span style="COLOR: blue">try</SPAN></P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; {</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; Controls.Add(<span style="COLOR: blue">this</SPAN>.Page.LoadControl(userControl));</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; }</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; <span style="COLOR: blue">catch</SPAN> (<span style="COLOR: teal">Exception</SPAN> exception)</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; {</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; <span style="COLOR: blue">string</SPAN> message = <span style="COLOR: blue">string</SPAN>.Format(<span style="COLOR: maroon">"{0} failed to load: {1}"</SPAN>, </P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; userControl,</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; exception.Message);</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; Controls.Add(<span style="COLOR: blue">new</SPAN> <span style="COLOR: teal">LiteralControl</SPAN>(message));</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; }</P><p style="MARGIN: 0px">&#160;&#160;&#160; &#160;&#160;&#160; }</P><p style="MARGIN: 0px">&#160;&#160;&#160; }</P><p style="MARGIN: 0px">}</P></DIV><p></P><p>Now hit F5 and deploy! </P><p><a href="http://blog.mikeobrien.net/content/binary/SharePointWebPartsUserControlsOhMy_12E8E/image_10.png" atomicselection="true"><img style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" height=385 alt=image src="/content/ae21450cdb9e49988aecc02895895e53.png" width=570 border=0></A> </P><p>As you can see, this method gives you the benefit of the designer and VSeWSS solution deployment. The full source of the sample can be downloaded here:</P><a href="https://docs.google.com/uc?id=0Bynmohn6qHD_MmE5N2RjOTgtM2U1OC00YjFlLWJhMzItYjNiMWY0NDRkMzM0">MyGroovySharePointLibrary.zip (417.78 KB)</A>