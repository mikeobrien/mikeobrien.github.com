---
layout: post
title: USB HID Device .NET Library
tags: [USB HID, .NET]
---
<P>I recently had the opportunity to work with a 2d area scanner (aka Bar Code Reader) in a&#160;.NET&#160;application. Previously our client used proprietary software that just plain stunk so we decided to write our own software. One very cool thing I discovered while working on this project was that many USB devices (Like bar code scanners, joysticks, game pads, mice, keyboards, etc) sport a Human Interface Device (HID) interface. This interface communicates using the <A href="http://www.usb.org/developers/devclass_docs/HID1_11.pdf">standard HID protocol</A> defined by the <A href="http://www.usb.org">USB Implementers Forum</A>. The cool thing about this is that one standard device driver can be written and used for all USB HID devices on a particular platform. Normally you would have to write your own device driver or use an existing one to communicate with a USB device, ouch! USB HID eliminates that requirement. Windows ships with a standard USB HID device driver and automatically makes the HID interface available when a USB HID device is plugged into the system. Nothing to install, no device driver to write, yay! Windows also has a fairly easy to use API (Although a little quirky) for communicating with HID devices. <A href="http://www.lvr.com/hidpage.htm">This site</A>, run by Jan Axelson, has a lot of good information on communicating with USB HID devices. His book, <A href="http://www.amazon.com/USB-Complete-Everything-Develop-Peripherals/dp/1931448027/">USB Complete</A>, is also an invaluable resource, I would <STRONG>definitely</STRONG> recommend it if you will be doing HID development on any platform. </P>
<P>I have an HID .NET library available <A href="http://labs.mikeobrien.net/view.aspx?projectid=hidlibrary">here</A> if you want to skip most of the gory details and get right down to business. I have used this library in production and have not had any issues, please let me know if you have any feedback. Using this library, while encapsulating most of the underlying details, will require you to understand the format of data contained in the payload of the reports sent to and from the device. HID's communicate using "reports" which are analogous to packets in network terminology. The reports themselves are a standard USB HID data structure although the payload of these reports will be specific to the device or device type. Usually the payload data format can be found in the device SDK and/or by simply analyzing the payload data the device sends.</P>
<P>The following library, developed for the <A href="http://www.handheld.com/Site.aspx/na/en/products/categories/?cat=9&line=18">HHP IT4600/IT4800 area scanner</A>, uses the aforementioned HID library.</P><A href="/blog/downloads/IT4XXXScanner.zip">IT4XXXScanner.zip (1.98 MB)</A>