---
layout: post
title: Identities for different IIS7 Authentication Configurations
tags: [.NET, IIS 7]
redirect_from:
  - /blog/2009/01/identities-for-different-iis7.html
  - /PermaLink,guid,5e975b20-7b05-472f-bd80-04028ab8b6fa.aspx
---
<p>A few notes about identities from the standpoint of ASP.NET:</p> <p><strong><a href="http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.getcurrent.aspx">WindowsIdentity.GetCurrent()</a></strong> - This WindowsIdentity represents the OS thread identity or more specifically an <a href="http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/WhatIsAToken.html">account token</a> (Not to be confused with <a href="http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/WhatIsThreadDotCurrentPrincipal.html">Thread.CurrentPrincipal.Identity</a> which is just a simple container for your convenience). This token represents a LSA (Local Security Authority) or Active Directory account. This will always be the process identity set in the App Pool configuration (AKA the App Pool identity) unless you are doing impersonation. This is the actual identity (Or Windows account token) that code runs as. As far as Windows Security is concerned this is the only identity that matters. The only way to "change" this is to do <a href="http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/WhatIsImpersonation.html">impersonation</a> which is done on a thread by thread basis and should be reverted ASAP to the original identity to avoid a security hole (And resource leak because of unclosed handles). New threads always inherit the process token regardless of if the creating thread is impersonating another user (Something to remember when doing async calls in ASP.NET while impersonating).</p> <p><strong><a href="http://msdn.microsoft.com/en-us/library/system.threading.thread.currentprincipal.aspx">Thread.CurrentPrinciple.Identity</a> & <a href="http://msdn.microsoft.com/en-us/library/system.web.httpcontext.user.aspx">HttpContext.Current.User.Identity</a></strong> - These are set by ASP.NET during the authentication phase and will either be...</p> <ol> <li>...an Anonymous WindowsIdentity when doing just anonymous auth  <li>...a GenericIdentity when doing forms auth (Which implies anon auth).  <li>...a custom identity when doing custom auth (Which implies anon auth).  <li>...a WindowsIdentity representing the authenticating user when doing any other types of auth such as Basic, Windows or Challenge-Response. These two properties actually point to the same instance of the identity. This will be the same as the OS thread <strong><em>only</em></strong> when you are doing impersonation.</li></ol> <p><strong><a href="http://msdn.microsoft.com/en-us/library/system.web.httprequest.logonuseridentity.aspx">Request.LogonUserIdentity</a></strong> - This is a WindowsIdentity representing the authenticating user, regardless of the authentication type. This will be the same as the OS thread <strong><em>only</em></strong> when you are doing impersonation. It will be the same as Thread.CurrentPrinciple.Identity & HttpContext.Current.User.Identity only when you are not doing anonymous authentication.</p> <p>Here is a listing of the identities set by IIS7 auth in a number of configurations. They remained the same in both integrated and classic pipeline modes. </p> <p><strong>Anonymous (Specific User, which happens to be IUSR)</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</th> <th style="font-size: 10pt; font-family: arial">Identity Name</th></tr> <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\IUSR</td></tr></tbody></table> <p><strong>Anonymous (Specific User, which happens to be IUSR), Impersonation</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</td>  <th style="font-size: 10pt; font-family: arial">Identity Name</td></tr>  <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\IUSR</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\IUSR</td></tr></tbody></table> <p><strong>Anonymous (App Pool Identity, which happens to be NETWORK SERVICE)</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</td>  <th style="font-size: 10pt; font-family: arial">Identity Name</td></tr>  <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr></tbody></table> <p><strong>Anonymous (App Pool Identity, which happens to be NETWORK SERVICE), Impersonation</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</td>  <th style="font-size: 10pt; font-family: arial">Identity Name</td></tr>  <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr></tbody></table> <p><strong>Anonymous, Physical Path Credentials, LSA User</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</td>  <th style="font-size: 10pt; font-family: arial">Identity Name</td></tr>  <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr></tbody></table> <p><strong>Anonymous, Impersonation, Physical Path Credentials, LSA User</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</td>  <th style="font-size: 10pt; font-family: arial">Identity Name</td></tr>  <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">NTLM</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr></tbody></table> <p><strong>Basic, LSA User (Same for AD user)</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</th> <th style="font-size: 10pt; font-family: arial">Identity Name</th></tr> <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr></tbody></table> <p><strong>Impersonation, Basic Auth, and LSA User (Classic Pipeline Mode or Integrated Pipeline and validateIntegratedModeConfiguration=false)</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</th> <th style="font-size: 10pt; font-family: arial">Identity Name</th></tr> <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">NTLM</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr></tbody></table> <p><strong>Impersonation, Basic Auth, and AD User (Classic Pipeline Mode or Integrated Pipeline and validateIntegratedModeConfiguration=false)</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</td>  <th style="font-size: 10pt; font-family: arial">Identity Name</td></tr>  <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Kerberos</td> <td style="font-size: 10pt; font-family: arial">DOMAIN\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">DOMAIN\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">DOMAIN\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Basic</td> <td style="font-size: 10pt; font-family: arial">DOMAIN\username</td></tr></tbody></table> <p><strong>Forms, Anonymous Auth</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</th> <th style="font-size: 10pt; font-family: arial">Identity Name</th></tr> <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.GenericIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.GenericIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">&#160;</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">&#160;</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\IUSR</td></tr></tbody></table> <div>&#160;</div> <div><strong>Windows, LSA User (Same for AD user)</strong></div> <div>&#160;</div> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</th> <th style="font-size: 10pt; font-family: arial">Identity Name</th></tr> <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">NT AUTHORITY\NETWORK SERVICE</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr></tbody></table> <p><strong>Impersonation, Windows Auth, and LSA User (Classic Pipeline Mode or Integrated Pipeline and validateIntegratedModeConfiguration=false)</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</th> <th style="font-size: 10pt; font-family: arial">Identity Name</th></tr> <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">NTLM</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">HOST\username</td></tr></tbody></table> <p><strong>Impersonation, Windows Auth, and AD User (Classic Pipeline Mode or Integrated Pipeline and validateIntegratedModeConfiguration=false)</strong></p> <table border="1"> <tbody> <tr> <th style="font-size: 10pt; font-family: arial">Source</th> <th style="font-size: 10pt; font-family: arial">Type</th> <th style="font-size: 10pt; font-family: arial">Return Type</th> <th style="font-size: 10pt; font-family: arial">Authentication Type</td>  <th style="font-size: 10pt; font-family: arial">Identity Name</td></tr>  <tr> <td style="font-size: 10pt; font-family: arial">WindowsIdentity.GetCurrent()</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Kerberos</td> <td style="font-size: 10pt; font-family: arial">DOMAIN\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Thread.CurrentPrincipal.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">DOMAIN\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">HttpContext.Current.User.Identity</td> <td style="font-size: 10pt; font-family: arial">IIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">DOMAIN\username</td></tr> <tr> <td style="font-size: 10pt; font-family: arial">Request.LogonUserIdentity</td> <td style="font-size: 10pt; font-family: arial">WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">System.Security.Principal.WindowsIdentity</td> <td style="font-size: 10pt; font-family: arial">Negotiate</td> <td style="font-size: 10pt; font-family: arial">DOMAIN\username</td></tr></tbody></table> <p><strong><font size="4"></font></strong></p>