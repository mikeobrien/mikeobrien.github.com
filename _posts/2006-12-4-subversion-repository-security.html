---
layout: post
title: Subversion repository security configuration under subserve on Windows
categories: [Subversion, Infrastructure]
tags: [Subversion, Infrastructure]
---
<p>I want to start off by saying that I am <a href="/2006/11/running-subversion-server-as-windows_07.html">running subserve v1.4&#160;as a Windows service</A>. From what I have read configuration may be somewhat different when using httpd, SSH or on another OS. So the following may or may not fully apply to other access methods, versions&#160;or OS's. </P><p><strong><font size=3>svnserve.conf</FONT></STRONG></P><p>The first repository security configuration file you will encounter is the svnserve.conf file. It appears that Subversion looks for this file specifically under the "conf" folder within the repository tree. I don't believe there is a way to configure this path or the filename it looks for. This file has only one section called "general". It contains 5 basic security settings. The settings are as follows:</P><p><strong>anon-access</STRONG>: Valid values for this setting are read, write or none. This value specifies repository wide access for anonymous users.&#160;If there is a conflict with this setting and with folder permissions specified in the authz file, the most restrictive permission is applied.</P><p><strong>auth-access</STRONG>: Valid values for this setting are read, write or none. This value specifies repository wide access for authenticated users. If there is a conflict with this setting and with folder permissions specified in the authz file, the most restrictive permission is applied.</P><p><strong>password-db</STRONG>: This specifies a path to a user database. This can be an absolute path ("C:\config\passwd") or a relative path ("..\..\config\passwd"). If no path is specified only anonymous access will be supported. Only the anon-access permission will be in force.</P><p><strong>authz-db</STRONG>: This specifies a path to a folder permissions database. This can be an absolute path ("C:\config\authz") or a relative path ("..\..\config\authz"). If no path is specified then path based permissions are not applied. Only the anon-access and auth-access permissions will be in force.</P><p><strong>realm</STRONG>: This is a string that serves as a unique identifier which identifies a realm or security domain the repository is associated with. A realm is basically the user base contained in the user database (passwd file). Each repository that shares a single user database should have the same realm specified. So for example if you had a user database at "C:\config\passwd" which was used by three repositories, all three repositories should have the same realm specified.</P><p><strong><font size=3>passwd</FONT></STRONG></P><p>The second file you will encounter is the user database. The name of this file is passwd by default but can be anything. If user authentication is desired the path to this file must be set in the password-db setting in the svnserve.conf file. If no path is set for this setting,&#160;no user authentication will take place. The user database can be shared by multiple repositories. Each repository that shares a single user database should have the same realm specified. The user database contains only one section called "users". The settings in this group are username/password pairs. For example:</P><p><font face="Courier New" color=#006400>[users]<br />
bsimpson = </FONT><font face="Courier New" color=#006400>R@dio@ctiveM@n</FONT><br />
<font face="Courier New" color=#006400>lsimpson = Bl33dingGumsMurphy<br />
mburns=Smith3rs<br />
djquimby=V0t3Quimby</FONT></P><p><strong><font size=3>authz</FONT></STRONG></P><p>The third file you will encounter is the path based permissions database. The name of this file is authz by default but can be anything. If path based permissions are desired the path to this file must be set in the authz-db setting in the svnserve.conf file. This file defines user groups and path permissions. The first section in this file is called "groups". Here you can specify groups and their membership. Each setting is a group name and a comma separated user list. It does not appear that white space in this list causes any problems. Unfortunately as of&#160; Subversion 1.4 you cannot specify user groups in the user database (passwd), only in this file. Here is an example of the "groups" section:</P><p><font face="Courier New" color=#006400>[groups]<br />
admin = mburns, djquimby<br />
users =&#160; bsimpson, lsimpson</FONT></P><p>The sections that follow are path specific permissions. The section name is the path. The path begins with a forward slash but must not end with one. Evidently (As of Subversion 1.4) the "repository" prefix for repository specific permissions (IE: [repository:/yada/yada]) is ignored when using svnserve to access repositories. <a href="/2006/12/repository-specific-access-under_04.html">It appears that it is only recognized when using the httpd access method</A>. So separate files would have to be maintained to provide repository specific folder permissions. Otherwise if identical paths existed in two or more repositories the permissions for those paths would be identical, there would be no way to differentiate them.&#160;Each path permission section contains members which could be a group name prefixed with an ampersand (@), wildcard (*) denoting all users (Including anonymous) or simply a username. The permissions are &#8216;r' for readonly, &#8216;rw' for read/write or &#8216;' (Blank) for no access (Including anonymous users). Permissions are inherited from the parent folder if no permissions are specified for a particular path. If permissions conflict, the least restrictive permissions are applied. Here is an example of path permissions:</P><p><font face="Courier New" color=#006400>[/common]<br />
* = rw</FONT></P><p><font face="Courier New" color=#006400>[/config/admin]<br />
@admin=rw<br />
lsimpson=r</FONT></P><p><font face="Courier New" color=#006400>[/docs]<br />
@users=rw<br />
@admin=rw</FONT></P><p><font face="Courier New" color=#006400>[/secure]<br />
@admin=r<br />
@users=</FONT><br />
</P>