---
layout: post
title: Installing ThoughtWorks Cruise with File Authentication on Windows
categories: [ThoughtWorks Cruise]
tags: [ThoughtWorks Cruise]
---
<p><a href="http://studios.thoughtworks.com/cruise-release-management">ThoughtWorks Cruise</a> is a compelling option for continuous integration. Even more compelling is that they offer a free version (Although their recent marketing has been somewhat ambiguous on this, see <a href="http://community.thoughtworks.com/posts/e104868115">here</a> for more info). Setting up Cruise with file authentication is hardly worth a blog post since its so simple (Plus the docs do a good job of explaining it) but I'll do it anyways. </p>  <p>1) <strong>Download the latest version of the Cruise Server and Cruise Agent </strong><a href="http://studios.thoughtworks.com/user/register&destination=forms/form/cruise/download">here</a><strong>.</strong> Fill out the form and you will be redirected to a download page. You will also be emailed a license that is good for a year. You will have to renew this license every year. From what I have been told, your Cruise server will not stop working after a year, but you will not be able to make any changes to your pipelines until you have an updated license. Kind of a pain but I think it's worth it for a free product.</p>  <p>2)<strong> Install both the Cruise Server and Cruise Agent.</strong> The Cruise server coordinates the builds and the Cruise Agent actually performs tasks. So you could potentially have multiple agents on multiple servers which are handling build tasks in parallel. The free version only allows you to install agents on the same machine as the Cruise Server. The simplest Cruise install is Cruise Server and 1 Cruise Agent.</p>  <p>3) <strong>Enter your license key.</strong> Browse to the administrative control pane (<u><font color="#0066cc"><a href="http://localhost:8153">http://localhost:8153</a></font></u>) or by double clicking the icon on your desktop. The control panel can also be accessed over ssl by using port 8154: <u><font color="#0066cc"><a href="https://localhost:8154">https://localhost:8154</a></font></u>. This will redirect to the about page where you will need to enter your license information. You should have received a user name and license key by email. Enter the user name (Called "Licensee" in the email) and paste in the license key in appropriate box and press "Save license".</p>  <p>4) <strong>Create the user password file.</strong> Now you will need to create an Apache password file using the htpasswd utility in the Apache distribution. You can download the latest distro <a href="http://httpd.apache.org/download.cgi">here</a> (You can just copy the utility out of the folder and then uninstall Apache). Run the following command:</p>  <p>htpasswd -c -s "D:\Path\To\My\File\passwd" myusername</p>  <p>The "c" flag creates the file (Omit this when you are adding additional users). The "s" flag forces the SHA hashing algorithm which is what Cruise expects. Then of course the path to the password file and the username. You will be prompted for the password.</p>  <p>5) <strong>Set the path to the password file in the Cruise configuration.</strong> Now you will need to click on the "ADMINISTRATION" tab in the Cruise control panel then the "Source XML" sub tab. Here you will see the xml configuration for Cruise. Click the "Edit" button at the top of the file to make the textbox editable. Now add the following "security" section to the configuration:</p>  <pre class="code"><span style="color: blue"><?</span><span style="color: #a31515">xml </span><span style="color: red">version</span><span style="color: blue">=</span>"<span style="color: blue">1.0</span>" <span style="color: red">encoding</span><span style="color: blue">=</span>"<span style="color: blue">utf-8</span>"<span style="color: blue">?>
<</span><span style="color: #a31515">cruise </span><span style="color: red">... </span><span style="color: blue">>
  <</span><span style="color: #a31515">server </span><span style="color: red">artifactsdir</span><span style="color: blue">=</span>"<span style="color: blue">logs</span>"<span style="color: blue">>
    </span>...
    <span style="color: blue"><</span><span style="color: #a31515">security</span><span style="color: blue">>
      <</span><span style="color: #a31515">passwordFile </span><span style="color: red">path</span><span style="color: blue">=</span>"<span style="color: blue">D:\Path\To\My\File\passwd</span>" <span style="color: blue">/>
    </</span><span style="color: #a31515">security</span><span style="color: blue">>
    </span>...
  <span style="color: blue"></</span><span style="color: #a31515">server</span><span style="color: blue">>
  </span>...
<span style="color: blue"></</span><span style="color: #a31515">cruise</span><span style="color: blue">>
</span></pre>

<p>Click the save button and browse to another page in the admin. At this point you should be greeted with a login page.</p>