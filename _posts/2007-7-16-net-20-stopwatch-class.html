---
layout: post
title: .NET 2.0 Stopwatch Class
categories: [.NET, .NET 2.0]
tags: [.NET, .NET 2.0]
---
<p>The Stopwatch Class, another great .NET 2.0 feature I keep forgetting to use so I'll blog about it (And hopefully I'll remember ;)... This is a great class for performance monitoring, instead of declaring a start time and subtracting it from the end time, etc. The following snippet checks the performance difference in doing a square root and a tangent over a number of iterations. Internally, when the stopwatch is started, the ticks of the current time are set as the start timestamp. When it is stopped the start ticks and end ticks (Current time)&#160;are subtracted and the private elapsed&#160;time field&#160;(A Long) is updated. The elapsed field is only reset when you explicitly call Reset() as it is accumulative. The public Elapsed property conveniently returns a TimeSpan. </p> <p> <div style="font-size: 10pt; background: white; color: black; font-family: courier new"> <p style="margin: 0px"><span style="color: blue">int</span> iterations = 10000000;</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px"><span style="color: teal">Stopwatch</span> stopwatch = <span style="color: blue">new</span> <span style="color: teal">Stopwatch</span>();</p> <p style="margin: 0px">stopwatch.Start();</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px"><span style="color: green">// Do something...</span></p> <p style="margin: 0px"><span style="color: blue">for</span> (<span style="color: blue">int</span> index = 0; index < iterations; index++)</p> <p style="margin: 0px">{ <span style="color: teal">Math</span>.Sqrt(index); }</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px">stopwatch.Stop();</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px"><span style="color: teal">Console</span>.WriteLine(<span style="color: blue">string</span>.Format(<span style="color: maroon">"Square root took {0} "</span> + </p> <p style="margin: 0px">&#160;&#160;&#160; <span style="color: maroon">"milliseconds for {1} iterations."</span>,</p> <p style="margin: 0px">&#160;&#160;&#160; stopwatch.Elapsed.Milliseconds, iterations));</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px"><span style="color: green">// Do something else...</span></p> <p style="margin: 0px">stopwatch.Reset();</p> <p style="margin: 0px">stopwatch.Start();</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px"><span style="color: blue">for</span> (<span style="color: blue">int</span> index = 0; index < iterations; index++)</p> <p style="margin: 0px">{ <span style="color: teal">Math</span>.Tan(index); }</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px">stopwatch.Stop();</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px"><span style="color: teal">Console</span>.WriteLine(<span style="color: blue">string</span>.Format(<span style="color: maroon">@"Tangent took {0} "</span> +</p> <p style="margin: 0px">&#160;&#160;&#160; <span style="color: maroon">"milliseconds for {1} iterations."</span>,</p> <p style="margin: 0px">&#160;&#160;&#160; stopwatch.Elapsed.Milliseconds, iterations));</p> <p style="margin: 0px">&#160;</p> <p style="margin: 0px"><span style="color: teal">Console</span>.ReadKey();</p></div>