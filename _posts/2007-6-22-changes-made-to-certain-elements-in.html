--
layout: post
title: Changes made to certain elements in a VSeWSS project not appearing in SharePoint when it is deployed
categories: [Visual Studio 2005, .NET, IIS 6, VSeWSS, SharePoint 2007, SharePoint Solution Deployment]
tags: [Visual Studio 2005, .NET, IIS 6, VSeWSS, SharePoint 2007, SharePoint Solution Deployment]
--
<P>Another SharePoint anomaly... Will they ever end??? So I have had this strange issue where doing a deploy of a <A href="http://www.microsoft.com/downloads/details.aspx?familyid=19f21e5e-b715-4f0c-b959-8c6dcbdc1057&displaylang=en" target=_blank>VSeWSS</A> project does not seem to update the SharePoint site for certain elements like schemas. I have to retract/remove the solution manually from SP, close/reopen Visual Studio (Otherwise I would get a null ref error), then redeploy to see changes. The <A href="http://www.microsoft.com/downloads/details.aspx?familyid=19f21e5e-b715-4f0c-b959-8c6dcbdc1057&displaylang=en" target=_blank>VSeWSS</A> deploy process does an iisreset (Which I tried manually doing as well) but the updates do not appear without following the steps mentioned. I checked the SP database and SP hive and the elements in question were deployed... So the only thing I could think of is that these elements must cached in memory, which was baffling since an iisreset should clear that out (Right?). Well I finally got the bright idea to verify that iisreset was in fact closing out the IIS service process completely. And lo an behold it was not! After further investigation I found that the “<A href="http://msdn2.microsoft.com/en-US/library/aa384291.aspx" target=_blank>Windows Remote Management (WS-Management)</A>” service, <STRONG>which depends on IIS</STRONG>, was preventing a complete exit of the inetinfo process. I'm not sure what the iisreset was actually doing all along (It said it successfully reset the IIS services), possibly just recycling the AppDomain(s)? But in that case wouldn't SP release cached elements upon termination of the AppDomain(s)? Not really sure, but what I am sure of is that stopping and disabling the the WRM service allowed inetinfo to completely close when the service was restarted by iisreset. And voilà! My changes! </P>
<P>Incidentally I am running Virtual Server 2005 which is monitored by the "<A href="http://www.microsoft.com/systemcenter/scvmm/default.mspx" target=_blank>Virtual Machine Manager Agent</A>" service. This service depends on the WRM service. So disabling the WRM service will disable your VMMA service. You might want to let your network admin know you need this disabled or it might reappear.</P>