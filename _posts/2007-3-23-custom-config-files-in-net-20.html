---
layout: post
title: Custom Config Files in .NET 2.0
tags: [VB.NET, .NET, Configuration, C#]
redirect_from:
  - /blog/2007/03/custom-config-files-in-net-20.html
---
<P>I have been working with the new custom configuration classes in .NET 2.0 and they really make creating custom xml configuration a snap. They are a little quirky to use at first but once you get past the initial learning curve they really make the job a lot easier. </P>
<P>One thing I really wanted to figure out is how to use these new classes to read files other than the default app/web.config. For example if you have one config file that might be shared between exes or if a config file is pulled from a URL. Its actually pretty easy to do.</P>
<P>First create your custom configuration file. It will look exactly the same as a web/app.config file except it will only contain your custom section(s). Create a section handler element identifying the custom section handler and the name of the section. Again, nothing different from doing this in the app/web.config.</P>
<P><FONT face="Courier New" color=#000080><?xml version="1.0" encoding="utf-8" ?><BR><configuration><BR>&#160;<configSections><BR>&#160;&#160;<section name="mySettings" type="CustomConfigHandler.MySettingSection, CustomConfigHandler"/><BR>&#160;</configSections><BR>&#160;<mySettings><BR>&#160;&#160;<someSetting someAttribute="This is an attribute value from Settings1.config"/><BR>&#160;</mySettings><BR></configuration></FONT></P>
<P>Next create a Configuration object that points to your file by passing in an ExeConfigurationFileMap with the ExeConfigFilename set.</P>
<P><SPAN style="FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent"><SPAN style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">// Create an exe file map containing the path to your config file</SPAN><BR>ExeConfigurationFileMap FileMap <SPAN style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</SPAN> <SPAN style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">new</SPAN> ExeConfigurationFileMap();<BR>FileMap.ExeConfigFilename <SPAN style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</SPAN> <SPAN style="FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Courier New; BACKGROUND-COLOR: #e4e4e4">"MySystem.config"</SPAN>;<BR><BR><SPAN style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">// Create a configuration object that is tied to your custom config file.</SPAN><BR>Configuration Config <SPAN style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</SPAN> ConfigurationManager.OpenMappedExeConfiguration(FileMap, ConfigurationUserLevel.None);<BR><BR><SPAN style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">// Create the custom config section handler</SPAN><BR>MySettingSection MySettings <SPAN style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</SPAN> (MySettingSection)Config.GetSection(<SPAN style="FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Courier New; BACKGROUND-COLOR: #e4e4e4">"mySettings"</SPAN>);</SPAN></P><SPAN style="FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">
<P><SPAN style="FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">Console.WriteLine(MySettings.SomeSetting.SomeAttribute);</SPAN></P>
<P><SPAN style="FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent"></SPAN><BR></SPAN>The entire source can be downloaded here:</P><A href="/blog/downloads/ExternalConfigFile.zip">ExternalConfigFile.zip (40.24 KB)</A>