---
layout: post
title: Sargability...
categories: [TSQL/SQL Server]
tags: [TSQL/SQL Server]
---
<P>Recently I was looking up some information on enhancing query performance and came accross a new term; Sargable. A&#160;"contraction&#160;of Search ARGument"&#160;according the <A href="http://en.wikipedia.org/wiki/Sargable">wikipedia</A>. Basically sargability means that the DB server can&#160;take advantage of&#160;an index to speed up the query. WHERE clauses that arent sargable can cause a table scan because every value, in&#160;certain referenced column(s), in the entire table must be evaluated. One example would be <FONT face="Courier New" color=#008000>MyValue=LTRIM(SomeTable.SomeValue)</FONT>. The result of the <FONT face="Courier New" color=#008000>LTRIM</FONT> is not indexed, therefore every value, in the&#160;SomeValue column, in the SomeTable table&#160;must be evaluated.&#160;If possible, you can rework a clause so that DB server can take advantage of an index. For example, instead of saying <FONT face="Courier New" color=#006400>Year(ThisDate)=Year(GETDATE())</FONT> you could say <FONT face="Courier New" color=#008000>ThisDate BETWEEN YearBegin(GETDATE()) AND YearEnd(GETDATE())</FONT>. Where YearBegin and YearEnd are deterministic functions that return the first and last day of the year respectively. Or instead of saying <FONT face="Courier New" color=#006400>WHERE DATEDIFF(day, SomeDateField, GETDATE()) > 7</FONT> you could say <FONT face="Courier New" color=#006400>WHERE SomeDateField < DATEADD(day, -7, GETDATE())</FONT>. In the first statement, every record must be evaluated in order to see if the condition is true. But in the second statement the current date is processed with the DATEADD function to give is a max date&#160;and the evaluation is done with this constant result (Since the DATEADD on GETDATE will only be run once when the query starts) which could then take advantage of an index.&#160;If the clause cannot be reworked to be sargable then&#160;you could&#160;<A href="http://msdn2.microsoft.com/en-us/library/ms189292.aspx">create an indexed computed column</A>.</P>