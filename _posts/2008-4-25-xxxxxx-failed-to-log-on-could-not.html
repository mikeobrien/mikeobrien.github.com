---
layout: post
title: &quot;User xxxxxx failed to log on, could not access the home directory /.&quot; Error in IIS 6 FTP Using User Isolation with Active Directory
tags: [Security, FTP, IIS 6, Active Directory]
---
<p>So I had FTP setup on a Server '03 box with an FTP site configured to use user isolation mode with active directory. Everything was working great then all of a sudden users cant login and this error appears in the System events in the event log:</p>  <p><a href="http://blog.mikeobrien.net/content/binary/Use.ErrorinIIS6FTPUsingUserIsolationwith_BF94/image.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="219" alt="image" src="/blog/images/706880116abf465694093b402d326772.png" width="408" border="0" /></a> </p>  <p>This error, while true, doesn't really pinpoint the problem... But I found this <a href="http://www.microsoft.com/technet/community/columns/insider/default.mspx#EVD">wonderful article</a> that suggested that the account used by the FTP site to access AD was changed. "Oh yeah!", I said, "I did change that, D'OH!". Easy enough to fix; just open a command prompt and use the adsutil.vbs to update the AD account in the IIS metabase. </p>  <p><font face="Courier New" size="1">c:\Inetpub\Adminscripts\adsutil.vbs set msftpsvc/{FTP_SITE_ID}/ADConnectionsUserName MyDomain\MyFTPADUsername </font></p>  <p><font face="Courier New" size="1">c:\Inetpub\Adminscripts\adsutil.vbs set msftpsvc/{FTP_SITE_ID}/ADConnectionsPassword </font><a href="mailto:S0m3P@$$W0rd"><font face="Courier New" size="1">S0m3P@$$W0rd</font></a>&#160;</p>  <p>Remember to include the domain name with the username.</p>